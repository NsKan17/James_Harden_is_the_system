scale_fill_viridis_d(option = "plasma")
player |>
ggplot(aes(x = ws)) +
geom_histogram()+
scale_fill_viridis_c(option = "plasma")
player |>
ggplot(aes(x = ws)) +
geom_histogram(bins =25)+
scale_fill_viridis_c(option = "plasma")
player |>
ggplot(aes(x = ws)) +
geom_histogram(bins =25)+
scale_fill_viridis_c(option = "plasma")
player |>
ggplot(aes(x = ws)) +
geom_histogram(bins =25, fill =after_stat(count))+
scale_fill_viridis_c(option = "plasma")
player |>
ggplot(aes(x = ws)) +
geom_histogram(aes(fill = after_stat(count)), bins = 25, color = "white") +
scale_fill_viridis_c(option = "plasma") +
theme_minimal()
player |>
ggplot(aes(x = ws)) +
geom_histogram(aes(fill = after_stat(count)), bins = 25, color = "white") +
scale_fill_viridis_c(option = "plasma") +
theme_minimal()+
geom_vline(x = 8.3, color = "red")
player |>
ggplot(aes(x = ws)) +
geom_histogram(aes(fill = after_stat(count)), bins = 25, color = "white") +
scale_fill_viridis_c(option = "plasma") +
theme_minimal()+
geom_hline(x = 8.3, color = "red")
player |>
ggplot(aes(x = ws)) +
geom_histogram(aes(fill = after_stat(count)), bins = 25, color = "white") +
scale_fill_viridis_c(option = "plasma") +
theme_minimal()+
geom_hline(xintercept = 8.3, color = "red")
player |>
ggplot(aes(x = ws)) +
geom_histogram(aes(fill = after_stat(count)), bins = 25, color = "white") +
scale_fill_viridis_c(option = "plasma") +
theme_minimal()+
geom_vline(xintercept = 8.3, color = "red")
player |>
ggplot(aes(x = ws)) +
geom_histogram(aes(fill = after_stat(count)), bins = 25, color = "white") +
scale_fill_viridis_c(option = "plasma") +
theme_minimal()+
geom_vline(xintercept = 8.3, color = "red")+
annotate("text", x=8.4, y=30, label = "James Harden", color = "red")
player |>
ggplot(aes(x = ws)) +
geom_histogram(aes(fill = after_stat(count)), bins = 25, color = "white") +
scale_fill_viridis_c(option = "plasma") +
theme_minimal()+
geom_vline(xintercept = 8.3, color = "red")+
annotate("text", x=9, y=30, label = "James Harden", color = "red")
player |>
ggplot(aes(x = ws)) +
geom_histogram(aes(fill = after_stat(count)), bins = 25, color = "white") +
scale_fill_viridis_c(option = "plasma") +
theme_minimal()+
geom_vline(xintercept = 8.3, color = "red")+
annotate("text", x=11, y=30, label = "James Harden", color = "red")
#| label: setup
#| include: false
#This code chunk is set to include = FALSE so that the code and output do not appear in the final dashboard
library(tidyverse)
library(scales)
library(ggplot2)
library(janitor)
library(ggrepel)
library(ggiraph)
library(tidyverse)
nba_teams <- tibble(
team_name = c(
"Boston Celtics", "Brooklyn Nets", "New York Knicks", "Philadelphia 76ers", "Toronto Raptors",
"Chicago Bulls", "Cleveland Cavaliers", "Detroit Pistons", "Indiana Pacers", "Milwaukee Bucks",
"Atlanta Hawks", "Charlotte Hornets", "Miami Heat", "Orlando Magic", "Washington Wizards",
"Denver Nuggets", "Minnesota Timberwolves", "Oklahoma City Thunder", "Portland Trail Blazers", "Utah Jazz",
"Golden State Warriors", "Los Angeles Clippers", "Los Angeles Lakers", "Phoenix Suns", "Sacramento Kings",
"Dallas Mavericks", "Houston Rockets", "Memphis Grizzlies", "New Orleans Pelicans", "San Antonio Spurs"
),
acronym = c(
"BOS", "BKN", "NYK", "PHI", "TOR",
"CHI", "CLE", "DET", "IND", "MIL",
"ATL", "CHA", "MIA", "ORL", "WAS",
"DEN", "MIN", "OKC", "POR", "UTA",
"GSW", "LAC", "LAL", "PHX", "SAC",
"DAL", "HOU", "MEM", "NOP", "SAS"
)
)
write_csv(nba_teams, "nba_teams.csv")
team<- read.csv("test.csv")
team_analysis <-left_join(team, nba_teams, by = c("Team" = "team_name")) |>
clean_names()
y1 <- 116.8
y2 <- 111.9
x1 = 111
x2 = 110.4
player <- read.csv("player.csv") |>
clean_names()
player<- player |>
filter(g >= 41)|>
group_by(player) |>
filter(if(any(team == "2TM")) team == "2TM" else TRUE) %>%
ungroup()
player |>
ggplot(aes(x = ts, y = usg)) +
geom_point(aes(color = player == "James Harden")) +
geom_text_repel(
data = subset(player, player %in% c("James Harden")),
aes(label = player),
nudge_x = 0.03,
nudge_y = 3,
color = "red",
segment.color = "red",
) +
geom_text_repel(
data = subset(player, player %in% c("Stephen Curry")),
aes(label = player),
nudge_y = 1.7,
nudge_x = 0.04
) +
geom_text_repel(
data = subset(player, player %in% c("LeBron James")),
aes(label = player),
nudge_x = 0.05,
nudge_y = 0.5
) +
geom_text_repel(
data = subset(player, player %in% c("Alex Sarr")),
aes(label = player),
nudge_x = -0.005
) +
geom_text_repel(
data = subset(player, player %in% c("Jaxson Hayes")),
aes(label = player),
nudge_y = -1
) +
geom_text_repel(
data = subset(player, player %in% c("Gary Harris")),
aes(label = player),
nudge_y = -1
)+
scale_color_manual(values = c("FALSE" = "black", "TRUE" = "red"), guide = "none")
install.packages("maps")
library(tidyverse)
library(maps)
# States to highlight (use lowercase to match maps::map_data("state"))
highlight_states <- c(
"alabama","alaska","arizona","arkansas","california","colorado","connecticut",
"delaware","florida","georgia","hawaii","idaho","illinois","louisiana","maine",
"maryland","massachusetts","minnesota","mississippi","missouri","montana",
"nebraska","nevada","new hampshire","new jersey","new york","north carolina",
"oklahoma","oregon","pennsylvania","rhode island","south carolina","south dakota",
"texas","utah","vermont","virginia","washington","wyoming"
)
# States to highlight (use lowercase to match maps::map_data("state"))
highlight_states <- c(
"alabama","alaska","arizona","arkansas","california","colorado","connecticut",
"delaware","florida","georgia","hawaii","idaho","illinois","louisiana","maine",
"maryland","massachusetts","minnesota","mississippi","missouri","montana",
"nebraska","nevada","new hampshire","new jersey","new york","north carolina",
"oklahoma","oregon","pennsylvania","rhode island","south carolina","south dakota",
"texas","utah","vermont","virginia","washington","wyoming"
)
# States to highlight (use lowercase to match maps::map_data("state"))
highlight_states <- c(
"alabama","alaska","arizona","arkansas","california","colorado","connecticut",
"delaware","florida","georgia","hawaii","idaho","illinois","louisiana","maine",
"maryland","massachusetts","minnesota","mississippi","missouri","montana",
"nebraska","nevada","new hampshire","new jersey","new york","north carolina",
"oklahoma","oregon","pennsylvania","rhode island","south carolina","south dakota",
"texas","utah","vermont","virginia","washington","wyoming"
)
# Get US state polygons (lower 48 + AK/HI included; may appear far away)
states_sf <- map_data("state") %>%
as_tibble() %>%
mutate(is_highlight = region %in% highlight_states)
# Plot
ggplot(states_sf, aes(long, lat, group = group)) +
geom_polygon(aes(fill = is_highlight), color = "white", linewidth = 0.2) +
coord_fixed(1.3) +
scale_fill_manual(
values = c(`TRUE` = "#2C7FB8", `FALSE` = "grey90"),
name = NULL,
labels = c(`TRUE` = "Highlighted", `FALSE` = "Other")
) +
labs(
title = "Highlighted States",
x = NULL, y = NULL
) +
theme_minimal(base_size = 12) +
theme(
panel.grid = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
legend.position = "bottom"
)
# Plot
ggplot(states_sf, aes(long, lat, group = group)) +
geom_polygon(aes(fill = is_highlight), color = "white", linewidth = 0.2) +
coord_fixed(1.3) +
scale_fill_manual(
values = c(`TRUE` = "moccasin", `FALSE` = "grey90"),
name = NULL,
labels = c(`TRUE` = "Highlighted", `FALSE` = "Other")
) +
labs(
title = "Highlighted States",
x = NULL, y = NULL
) +
theme_minimal(base_size = 12) +
theme(
panel.grid = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
legend.position = "bottom"
)
# Plot
ggplot(states_sf, aes(long, lat, group = group)) +
geom_polygon(aes(fill = is_highlight), color = "white", linewidth = 0.2) +
coord_fixed(1.3) +
scale_fill_manual(
values = c(`TRUE` = "moccasin", `FALSE` = "purple"),
name = NULL,
labels = c(`TRUE` = "Visited", `FALSE` = "Not Visisted")
) +
labs(
title = "States Vararat Has Been to",
x = NULL, y = NULL
) +
theme_minimal(base_size = 12) +
theme(
panel.grid = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
legend.position = "bottom"
)
# Plot
ggplot(states_sf, aes(long, lat, group = group)) +
geom_polygon(aes(fill = is_highlight), color = "white", linewidth = 0.2) +
coord_fixed(1.3) +
scale_fill_manual(
values = c(`TRUE` = "moccasin", `FALSE` = "lavender"),
name = NULL,
labels = c(`TRUE` = "Visited", `FALSE` = "Not Visisted")
) +
labs(
title = "States Vararat Has Been to",
x = NULL, y = NULL
) +
theme_minimal(base_size = 12) +
theme(
panel.grid = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
legend.position = "bottom"
)
# State polygons
states <- map_data("state") %>%
as_tibble() %>%
mutate(is_highlight = region %in% highlight_states)
# Compute label positions (centroids) for non-highlighted states
state_labels <- states %>%
filter(!is_highlight) %>%
group_by(region) %>%
summarise(
long = mean(range(long)),
lat  = mean(range(lat)),
.groups = "drop"
)
# Plot
ggplot(states, aes(long, lat, group = group)) +
geom_polygon(aes(fill = is_highlight), color = "white", linewidth = 0.2) +
geom_text(
data = state_labels,
aes(long, lat, label = str_to_title(region)),
size = 3,
color = "black"
) +
coord_fixed(1.3) +
scale_fill_manual(
values = c(`TRUE` = "moccasin", `FALSE` = "lavender"),
guide = "none"
) +
labs(
title = "Highlighted vs Non-Highlighted States",
x = NULL, y = NULL
) +
theme_minimal(base_size = 12) +
theme(
panel.grid = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank()
)
# Plot
ggplot(states, aes(long, lat, group = group)) +
geom_polygon(aes(fill = is_highlight), color = "white", linewidth = 0.2) +
geom_text(
data = state_labels,
aes(long, lat, label = str_to_title(region)),
size = 3,
color = "black"
) +
coord_fixed(1.3) +
scale_fill_manual(
values = c(`TRUE` = "moccasin", `FALSE` = "lavender"),
guide = "none"
) +
labs(
title = "Highlighted vs Non-Highlighted States",
x = NULL, y = NULL
) +
theme_minimal(base_size = 12) +
theme(
panel.grid = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank()
)
# State polygons
states <- map_data("state") %>%
as_tibble() %>%
mutate(is_highlight = region %in% highlight_states)
# Compute label positions (centroids) for non-highlighted states
state_labels <- states %>%
filter(!is_highlight) %>%
group_by(region) %>%
summarise(
long = mean(range(long)),
lat  = mean(range(lat)),
.groups = "drop"
)
# Plot
ggplot(states, aes(long, lat, group = group)) +
geom_polygon(aes(fill = is_highlight), color = "white", linewidth = 0.2) +
geom_text(
data = state_labels,
aes(long, lat, label = str_to_title(region)),
size = 3,
color = "black"
) +
coord_fixed(1.3) +
scale_fill_manual(
values = c(`TRUE` = "moccasin", `FALSE` = "lavender"),
guide = "none"
) +
labs(
title = "Highlighted vs Non-Highlighted States",
x = NULL, y = NULL
) +
theme_minimal(base_size = 12) +
theme(
panel.grid = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank()
)
# Plot
ggplot(states, aes(long, lat, group = group)) +
geom_polygon(aes(fill = is_highlight), color = "white", linewidth = 0.2) +
geom_text(
data = state_labels,
aes(long, lat, label = str_to_title(region)),
size = 3,
color = "black"
) +
coord_fixed(1.3) +
scale_fill_manual(
values = c(`TRUE` = "moccasin", `FALSE` = "lavender"),
guide = "none"
) +
labs(
title = "Highlighted vs Non-Highlighted States",
x = NULL, y = NULL
) +
theme_minimal(base_size = 12) +
theme(
panel.grid = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank()
)
library(tidyverse)
library(maps)
highlight_states <- c(
"alabama","alaska","arizona","arkansas","california","colorado","connecticut",
"delaware","florida","georgia","hawaii","idaho","illinois","louisiana","maine",
"maryland","massachusetts","minnesota","mississippi","missouri","montana",
"nebraska","nevada","new hampshire","new jersey","new york","north carolina",
"oklahoma","oregon","pennsylvania","rhode island","south carolina","south dakota",
"texas","utah","vermont","virginia","washington","wyoming"
)
states <- map_data("state") %>%
as_tibble() %>%
mutate(is_highlight = region %in% highlight_states)
state_labels <- states %>%
filter(!is_highlight) %>%
group_by(region) %>%
summarise(
long = mean(range(long)),
lat  = mean(range(lat)),
.groups = "drop"
)
ggplot(states, aes(x = long, y = lat, group = group)) +
geom_polygon(aes(fill = is_highlight), color = "white", linewidth = 0.2) +
geom_text(
data = state_labels,
inherit.aes = FALSE,  # <-- key fix
aes(x = long, y = lat, label = str_to_title(region)),
size = 3,
color = "black"
) +
coord_fixed(1.3) +
scale_fill_manual(values = c(`TRUE` = "#2C7FB8", `FALSE` = "grey90"), guide = "none") +
labs(title = "Highlighted vs Non-Highlighted States", x = NULL, y = NULL) +
theme_minimal(base_size = 12) +
theme(
panel.grid = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank()
)
library(ggrepel)
highlight_states <- c(
"alabama","alaska","arizona","arkansas","california","colorado","connecticut",
"delaware","florida","georgia","hawaii","idaho","illinois","louisiana","maine",
"maryland","massachusetts","minnesota","mississippi","missouri","montana",
"nebraska","nevada","new hampshire","new jersey","new york","north carolina",
"oklahoma","oregon","pennsylvania","rhode island","south carolina","south dakota",
"texas","utah","vermont","virginia","washington","wyoming","district of columbia"
)
states <- map_data("state") %>%
as_tibble() %>%
mutate(is_highlight = region %in% highlight_states)
state_labels <- states %>%
filter(!is_highlight) %>%
group_by(region) %>%
summarise(
long = mean(range(long)),
lat  = mean(range(lat)),
.groups = "drop"
)
ggplot(states, aes(x = long, y = lat, group = group)) +
geom_polygon(aes(fill = is_highlight), color = "white", linewidth = 0.2) +
geom_text_repel(
data = state_labels,
inherit.aes = FALSE,  # <-- key fix
aes(x = long, y = lat, label = str_to_title(region)),
size = 3,
color = "black"
) +
coord_fixed(1.3) +
scale_fill_manual(values = c(`TRUE` = "#2C7FB8", `FALSE` = "grey90"), guide = "none") +
labs(title = "Highlighted vs Non-Highlighted States", x = NULL, y = NULL) +
theme_minimal(base_size = 12) +
theme(
panel.grid = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank()
)
ggplot(states, aes(x = long, y = lat, group = group)) +
geom_polygon(aes(fill = is_highlight), color = "white", linewidth = 0.2) +
geom_text_repel(
data = state_labels,
inherit.aes = FALSE,
aes(x = long, y = lat, label = str_to_title(region)),
size = 3,
box.padding = 0.4,
point.padding = 0.2,
max.overlaps = Inf,
min.segment.length = 0
) +
coord_map(
projection = "albers",
lat0 = 39, lat1 = 45,
xlim = c(-125, -66),
ylim = c(24, 50)
) +
scale_fill_manual(
values = c(`TRUE` = "#2C7FB8", `FALSE` = "grey90"),
guide = "none"
) +
labs(
title = "Highlighted vs Non-Highlighted States",
x = NULL, y = NULL
) +
theme_minimal(base_size = 12) +
theme(
panel.grid = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank()
)
ggplot(states, aes(x = long, y = lat, group = group)) +
geom_polygon(aes(fill = is_highlight), color = "white", linewidth = 0.2) +
geom_text_repel(
data = state_labels,
inherit.aes = FALSE,  # <-- key fix
aes(x = long, y = lat, label = str_to_title(region)),
size = 3,
color = "black"
) +
coord_fixed(1.3) +
scale_fill_manual(values = c(`TRUE` = "#2C7FB8", `FALSE` = "grey90"), guide = "none") +
labs(title = "Highlighted vs Non-Highlighted States", x = NULL, y = NULL) +
theme_minimal(base_size = 12) +
theme(
panel.grid = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank()
)
